## Личный кабинет разработчика
### Личный кабинет разработчика

Личный кабинет разработчика — это сервис, который упрощает работу над приложениями для магазина приложений.

В личном кабинете можно:
 
- Создавать Черновики приложений; 
- Редактировать Черновики приложений и просматривать информацию о приложениях в прочих статусах;
- Редактировать информацию о разработчике; 
- Отправлять Черновики приложений на модерацию;
- Следить за статусом публикации своих приложений;
- Предоставлять и продлевать пробный период для платных приложений; 
- Привязывать аккаунты в МоемСкладе к аккаунту в личном кабинете для отладки неопубликованных приложений;
- Просматривать отчеты по установкам и выручке;
- Просматривать, скачивать и согласовывать отчет;
- Просматривать отчет по причинам удаления приложений. 

### Получение доступа к личному кабинету разработчика

Для получения доступа в личный кабинет разработчика заполните [анкету](https://dev.moysklad.ru/#anketa). Доступ и дальнейшие инструкции будут высланы на почту, указанную в анкете, в течение нескольких дней.

### Жизненный цикл приложения 

Статусы жизненного цикла приложения для магазина приложений:

- **Черновик (Draft)** — статус черновика, предназначен для разработки и тестирования. Приложение не отображается на витрине у пользователей МоегоСклада.
- **Готово, отправлено на модерацию (Ready)** — статус готовности. Приложение готово к публикации со стороны разработчика. Сотрудники МоегоСклада проверят приложение перед публикацией. Приложение не отображается на витрине у пользователей МоегоСклада.
- **Опубликовано (Published)** — приложение опубликовано на витрине приложений и доступно к установке пользователями МоегоСклада.
- **Снято с публикации (Hidden)** — публикация приложения приостановлена. Приложение исчезает с витрины, но у текущих пользователей приложения сохраняется возможность работать с ним. 
- **Версия опубликована (Merged)** — версия приложения опубликована на витрине приложений. Данный статус является внутренним, и не отображается в списке приложений и на витрине. 

Жизненный цикл приложения:

1. Приложение создается в [личном кабинете разработчика](#lichnyj-kabinet-razrabotchika) со статусом **Draft**. Разработчик проверяет и отлаживает работу приложения на своем аккаунте. Когда приложение готово, разработчик передает его на публикацию. Статус приложения меняется на **Ready**.
2. Сотрудник МоегоСклада проверяет, затем публикует приложение на витрине. Статус приложения меняется на **Published**. Приложение становится доступно пользователю МоегоСклада для установки.
3. Пользователь МоегоСклада устанавливает (подключает) приложение на свой аккаунт, настраивает и использует. Если приложение не нужно, пользователь может удалить (отключить) приложение на аккаунте. 
4. Разработчик может внести изменения в опубликованное приложение, создав для нее новую версию и внеся в нее изменения.
5. Чтобы убрать приложение с витрины приложений, его нужно перевести в статус **Hidden**. Установленные до этого момента экземпляры приложения на аккаунтах пользователей продолжают работать и отображаться на UI МоегоСклада, пока пользователи их не удалят. Для аккаунтов, удаливших приложение, и аккаунтов, на которых оно не было установлено, приложение скрывается. Установка приложения становится невозможной. Так можно скрыть только бесплатные приложения.

#### Создание черновика приложения

1. В личном кабинете разработчика нажмите на кнопку **Создать приложение**. Откроется форма создания черновика приложения. 
2. Укажите **Псевдоним приложения**. Псевдоним — уникальный идентификатор. Невозможно создать два приложения с одинаковыми псевдонимами. 
3. Создайте приложение подходящего типа: Серверное приложение, Телефония. Тип приложения влияет на его платность и необходимость заполнения Дескриптора: 

- **Серверное приложение**. Дескриптор приложения обязателен для заполнения. Правила заполнения дескриптора смотрите в разделе [Дескриптор приложения](#deskriptor-prilozheniq). Создается с одним бесплатным тарифом. Можно изменить стоимость или добавить новые тарифы при редактировании.
- **Телефония**. Не может быть платным, не нужно заполнять Дескриптор. Телефония оплачивается пользователем отдельно через опцию CRM.

#### Редактирование черновика приложения

Если после создания приложения его настройки нужно изменить, выберите приложение в списке приложений и нажмите в меню **Редактировать**.

На вкладке **Общая информация о приложении** доступны те же поля, что и в форме создания черновика приложения. Исключение составляет только **Псевдоним приложения** - его изменять после создания нельзя.

На вкладке **Учетные данные приложения** отображаются параметры для идентификации приложения:

- **Прямая ссылка на приложение**. Публичная ссылка для прямого доступа к приложению на витрине приложений МС.
- **Идентификатор приложения (appId)**. Используется как параметр запроса при взаимодействии по [Vendor API](#vendor-api-1-0).
- **Глобальный идентификатор (appUid)**. Используется для формирования JWT.
- **Секретный ключ**. Используется для подписи JWT. Для просмотра нажмите на кнопку «глаз» у скрытого точками поля, для генерации нового ключа — кнопку **Сгенерировать**.

Для всех полей доступна кнопка **Копировать**, которая вставляет содержимое поля в буфер обмена.

По умолчанию Серверные приложения создаются с одним бесплатным тарифом. Для изменения стоимости приложения предназначен раздел **Создание и редактирование тарифов** на вкладке **Тарифы**. 

_Вкладка доступна только для Серверных приложений._

Для добавления тарифа нажмите кнопку **Добавить новый тариф** и заполните его поля:

- **Название тарифа**. Должно быть кратким и давать представление о сути тарифного плана. Примеры: Лайт, Мидл, Профи и т.д. Для приложений с одним тарифом не выводится на витрине.
- **Платный**. Признак платности. Для того чтобы сделать тариф бесплатным, уберите галочку. Бесплатным может быть только один тариф.
- **Стоимость**. Задает стоимость приложения в рублях в месяц. Для платного тарифа является обязательным полем.
- **Триал**. Признак наличия [Пробного периода](#probnyj-period-platnyh-prilozhenij). Требует указания длительности в днях. Максимальная длительность — 14 дней. Триальным может быть только один тариф.
- **Описание**. Помогает пользователям сравнивать тарифы. Является обязательным в случае наличия 2-х и более тарифов у приложения.

Подробнее о выборе стоимости приложений в разделе [Стоимость приложения](#stoimost-prilozheniq).

#### Отправка на модерацию 

Перед публикацией на витрине МоегоСклада новое приложение должно пройти модерацию.

Чтобы отправить приложение на модерацию, выберите нужное приложение в статусе **Черновик** из списка и нажмите пункт меню **Отправить на модерацию**.

Обязательно заполните поле **Электронная почта для уведомлений** в разделе [Реквизиты / Информация о разработчике](https://apps.moysklad.ru/cabinet/vendordetails). Это позволяет получать оповещения и следить за процессом прохождения модерации.

После того как приложение отправлено на модерацию, его нельзя редактировать. Редактирование становится доступным снова, если модератор возвращает приложение на доработку.

#### Просмотр опубликованного приложения

Для просмотра информации о приложении выберите его в списке приложений и нажмите в меню пункт **Посмотреть приложение**.

В форме просмотра отображаются те же поля, что и в форме редактирования черновика приложения, но все они находятся в режиме только для чтения («read-only»).

#### Внесение изменений в опубликованное приложение

_Функция доступна только для Серверных приложений._

Для изменения данных опубликованного приложения, выберите его в списке приложений и нажмите в меню пункт **Создать версию для редактирования**. 
После этого в списке приложения появится новая версия в виде черновика, в которую будут скопированы данные из опубликованного приложения. 
В списке приложений она будет отображаться в виде строки, вложенной в исходное (опубликованное) приложение. 
После создания версии приложения работать с ней можно как с обычным черновиком: изменять параметры, отлаживать на витрине и т.д.

Отличия от обычных черновиков следующие:

- У версии свои собственные идентификаторы приложения (appId и appUid), а также секретный ключ. 
Идентификаторы существующих тарифов у опубликованного приложения и версии совпадают.
- Нельзя удалять существующие тарифы (те, которые есть в опубликованном приложении), но можно их скрывать.
- Нельзя менять стоимость и признак платности у существующих тарифов.
- Нельзя создавать более одной версии для одного опубликованного приложения.

После проверки внесенных изменений версия, так же как и черновик, отправляется на модерацию. 
После успешной публикации версия скрывается, а измененные поля переносятся в опубликованное приложение (в том числе увеличивается номер версии). 
При этом следующие поля остаются неизменными (не переносятся из черновика):

- Идентификатор приложения (appId).
- Псевдоним приложения.
- Секретный ключ (secretKey).

#### Скрытие и восстановление тарифов

Если вы не хотите поддерживать функциональность определенного тарифа приложения, вы можете скрыть этот тариф.

Для скрытия тарифа опубликованного приложения нужно **Создать версию для редактирования** (как было описано выше), 
скрыть соответствующий тариф и отправить версию на модерацию.

После публикации версии со скрытым тарифом пользователи, которые уже успели его подключить и настроили автопролонгацию, смогут продолжить им пользоваться.
Остальные пользователи уже не смогут его подключить. Также будут отменены все запланированные пролонгации на данный тариф.

Особенности работы со скрытыми тарифами:

* Скрыть можно только опубликованные тарифы. Тариф, который вы добавили в версии, но не опубликовали, можно удалять.
* Если бесплатный тариф скрыт, то нельзя создать новый бесплатный тариф. Чтобы вернуть бесплатный тариф, его необходимо восстановить.
* Когда тариф с триальным периодом скрывается, его признак триальности сбрасывается. Триальные дни можно присвоить другому опубликованному тарифу или, восстановив скрытый тариф, повторно установить у него триал.
* Скрытые тарифы можно не отображать в редакторе тарифов: для этого снимите флажок **Показывать скрытые тарифы**.
* Скрытые тарифы продолжают участвовать в валидации: даже если тариф скрыт, нельзя создать другой тариф с такими же названием и ценой.  

Для восстановления скрытого ранее тарифа: 

* Если изменения еще не были опубликованы, достаточно нажать кнопку **Восстановить тариф**.
* Если изменения уже были опубликованы, необходимо снова создать версию, восстановить тариф и отправить версию на публикацию.   

#### Ручная приостановка приложения 
 
В личном кабинете разработчик может тестировать и отлаживать приложение при приостановке и возобновлении на аккаунте.

Чтобы протестировать приложение при приостановке:

1. Привяжите аккаунт в МоемСкладе к аккаунту разработчика в личном кабинете разработчика (создайте аккаунт разработчика).
2. Заведите платное приложение в личном кабинете разработчика.
3. Установите приложение на аккаунте разработчика.
4. Выберите приложение в списке и нажмите на меню **Приостановить на аккаунте**. Работа приложения будет приостановлена.
5. Чтобы отладить приложение при возобновлении работы, нажмите на кнопку **Активировать** в карточке приложения на витрине МоегоСклада.

Приостановка возможна только для платных черновиков приложений, которые уже установлены или устанавливаются. 

#### Продление пробного периода платного приложения

В личном кабинете разработчика можно [продлить пробный период](#prodlenie-probnogo-perioda) приложения. Продление на выбранном аккаунте пользователя доступно один раз и только для платных опубликованных приложений. Для этого:

1. В Списке приложений выберите платное опубликованное приложение.
1. Нажмите на пункт меню **Дополнительный триал**.
1. В окне **Предоставление пробного периода** заполните поля **Аккаунт** и **Количество дней**. 
1. Для приложения с несколькими тарифами, выберите тариф, на который нужно предоставить пробный период.
1. Если поля заполнены корректно, откроется окно **Подтверждение пробного периода**. 
1. Проверьте указанный пробный период и нажмите на кнопку **Да, предоставить**. 

### Редактирование информации о разработчике

Чтобы отредактировать информацию о разработчике приложения, в меню личного кабинета перейдите на вкладку [Реквизиты / Информация о разработчике](https://apps.moysklad.ru/cabinet/vendordetails).

Функция доступна, пока на аккаунте отсутствуют приложения или есть только Черновики. В остальных случаях данные доступны 
только для просмотра, для изменения обратитесь к модератору МоегоСклада.

Также можно внести или отредактировать реквизиты для выплат денежных средств за платные приложения. Для этого в меню перейдите на вкладку [Реквизиты / Реквизиты компании](https://apps.moysklad.ru/cabinet/bankdetails).

### Привязка аккаунта к разработчику

Отладить приложение для магазина приложений можно на аккаунте разработчика. Чтобы сделать аккаунт в МоемСкладе аккаунтом разработчика, свяжите аккаунт с нужным разработчиком. Для этого в личном кабинете разработчика, в верхнем меню нажмите на кнопку **Привязать**.

**Важно:** Для привязки необходим доступ к электронной почте сотрудника, указанного в аккаунте МоегоСклада на странице 
Подписка. По умолчанию это администратор, зарегистрировавший аккаунт. Однако далее вместо администратора можно указать другого сотрудника.

Чтобы изменить уже существующую привязку, нажмите на имя текущей привязки. Предыдущая привязка будет удалена, установленные на отвязанном аккаунте приложения в статусах **Черновик (Draft)** и **Готово, отправлено на модерацию (Ready)** будут деинсталлированы.

### Отладка приложений на аккаунтах разработчика

Отладить неопубликованное приложение можно в аккаунте разработчика. Неопубликованные приложения разработчика находятся на витрине приложений в блоке **Приложения в разработке**. Неопубликованные приложения видит только разработчик, для пользователей они не видны. 

Неопубликованные приложения можно подключать и отключать так же, как и обычные опубликованные приложения. 

### Отчеты в личном кабинете разработчика

#### Сводный отчет по установкам приложений

В данном отчете можно посмотреть сколько активных установок есть у приложений, сколько из них пробных и оплачиваемых. Также можно посмотреть сколько приостановленных установок.

Для просмотра отчета по установкам необходимо перейти в раздел **Отчеты** в верхнем меню и выбрать вкладку **Установки**.

В отчет включаются:

 - Все приложения независимо от платности и наличия установок
 - В статусе **Опубликовано** и **Снято с публикации**.

#### Отчет по выручке платных приложений

Отчет предоставляет информацию о том, сколько приложение заработало денежных средств. Учитываются только реально оплачиваемые установки. Установки приложений на Пробном тарифе и с Пробным периодом не учитываются.

Для просмотра отчета по выручке необходимо в разделе **Отчеты** верхнего меню выбрать вкладку **Выручка**.

В отчет включаются:

  - Приложения во всех [статусах](#zhiznennyj-cikl-prilozheniq). 
  - Платные приложения, у которых есть хотя бы одна успешная установка.
  - Бесплатные приложения, если ранее они были платными и имели успешные установки.

#### Отчет об использовании приложений

Отчет об использовании приложений является основанием для выплаты разработчику денежных средств за использование приложения пользователями МоегоСклада. Отчет содержит информацию о том, сколько денег заработало каждое приложение в отдельности и все приложения разработчика вместе за месяц.

Для просмотра и согласования отчета в разделе **Отчеты** верхнего меню выберите вкладку **Выплаты**.

Отчет формируется раз в месяц, доступен для скачивания в формате PDF. Процесс работы с отчетом:

1. Чтобы отчет сформировался, заполните реквизиты.
2. Отчет поступает в статусе **Сформировано**. На почту приходит оповещение.
3. Просмотрите и согласуйте отчет (кнопка **Согласовать**). Статус отчета меняется на **Согласовано**.
4. Вознаграждение разработчика выплачивается согласно банковским реквизитам. В отчете появляется отметка **Выплачено**.

Если по отчету есть вопросы или возражения, не согласовывайте его и обратитесь к сотруднику МоегоСклада.

#### Отчет по причинам удаления приложений

При удалении приложения на витрине МоегоСклада пользователю предлагается оставить отзыв о приложении:

![useful image](removal-feedback.png)

Если пользователь указывает одну и более причин удаления и нажимает на кнопку **Отправить отзыв**, разработчик получает этот отзыв.<br/>
На email разработчика, указанный в личном кабинете в разделе:<br/>
**Реквизиты -> Информация о разработчике -> Контакты разработчика -> Электронная почта для уведомлений**<br/>
приходит сообщение с причинами удаления.

Список всех отзывов пользователей отображается в отчете **Причины удаления приложений**. Чтобы просмотреть его, в разделе **Отчеты** верхнего меню выберите вкладку **Причины удаления**.

Чтоба настроить отправку писем, отметьте флагом "Отправлять уведомления о причинах удаления приложений на email". Если функция отключена, отзывы продолжают собираться в данный отчет.

**Ограничение:** В отчете выводятся только 1000 последних отзывов за выбранный период.

### Права доступа для приложений

Чтобы серверное приложение получило доступ к JSON API, в дескрипторе приложения нужно указать желаемый уровень доступа к JSON API. Можно запросить следующие уровни доступа:

* **admin** — соответствует пользовательской роли `Системный администратор`. Приложение получает полный доступ ко всем отчетам, сущностям и документам в МоемСкладе. Уровень в перспективе будет устранен.

* **custom** — соответствует пользовательской роли `Индивидуальная роль`. Приложение получает доступ только к указанным в дескрипторе отчетам, сущностям и документам. Уровень рекомендуется для использования всеми приложениями кроме тех, которые работают с вебхуками и задачами.
 
Права приложения на аккаунте фиксируются на момент установки приложения. При последующем обновлении дескриптора приложения права приложения на аккаунте сохраняются. 

При разработке приложений одновременно могут существовать и работать установки приложений с разными правами. Необходимо в том или ином виде поддерживать работу приложения с несколькими наборами прав. 

Предоставление приложению новых дополнительных прав должно происходить через явное согласие пользователя. Этот механизм будет реализован в будущем. Сейчас пользователь может обновить права через переустановку. Нужно следить, чтобы при удалении приложения данные аккаунта сохранялись некоторое время. 

Подробнее о ролях пользователей смотрите в [документации JSON API](https://dev.moysklad.ru/doc/api/remap/1.2/dictionaries/#sushhnosti-sotrudnik-rabota-s-pravami-sotrudnika).

Подробнее о правах доступа для приложений смотрите в разделе [Информация о правах доступа](#blok-access).

### Прямая ссылка на приложение

Разработчик может получить прямую ссылку на приложение. 

Для этого в [личном кабинете разработчика](#lichnyj-kabinet-razrabotchika) перейдите в режим просмотра или редактирования приложения и скопируйте прямую ссылку на приложение. 

Также прямую ссылку можно получить в витрине приложений из адресной строки браузера, если открыть карточку приложения на витрине.

При переходе по короткой ссылке открывается витрина с карточкой приложения. Если пользователь авторизован, витрина с карточкой открывается сразу. Если нет, для просмотра необходимо авторизаваться.

Если приложение было удалено или недоступно по прямой ссылке, при переходе по ссылке открывается витрина и появляется сообщение о том, что приложение не найдено.
 
Если приложение снято с публикации, но уже установлено некоторыми пользователями, оно будет отображаться для этих пользователей по ссылке как на витрине. Для остальных пользователей приложение будет недоступно.

### Создание и загрузка инструкции для пользователя

> Пример инструкции приложения (index.html)

```html
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Приложение Онлайн-заказ</title>
    <link rel="stylesheet"
          type="text/css"
          href="https://apps-api.moysklad.ru/js/ns/appstore/app/v1/moysklad-manual.css"/>
    <script type="text/javascript"
            src="https://apps-api.moysklad.ru/js/ns/appstore/app/v1/moysklad-manual.js"></script>
</head>
<body>
    <h1>Приложение Онлайн-заказ</h1>
    <p>Приложение Онлайн-заказ существенно упрощает работу с оптовыми и розничными продажами.</p>
    ...
    <h2>Установка приложения</h2>
    ...
    <h2>Создание ссылки на каталог товаров</h2>
    <p>Можно создать общедоступную ссылку на каталог товаров, единый для всех покупателей, поделиться ссылкой на конкретный товар из каталога, чтобы его прорекламировать, а также создать ссылку на специальный каталог для конкретного контрагента.</p>
    <p>Все общедоступные ссылки собраны на стартовой странице приложения Онлайн-заказ.</p>
    <img src="1.png" alt="Стартовая страница приложения Онлайн-заказ">
    <h3>Создать общедоступную ссылку на каталог товаров</h3>
    <p>Чтобы быстро начать продавать товары в интернете, достаточно создать ссылку на каталог товаров, разместить ее в разных каналах продаж и начать принимать заказы в МоемСкладе.</p>
    ...
    <h3>Создать ссылку на каталог для конкретного контрагента</h3>
    ...
    <h2>Настройка валют</h2>
    ...
</body>
</html>
```

> Пример структуры архива

```
.
└── online-order.zip
    ├── 1.png
    ├── 2.jpeg
    ├── 3.jpg
    ├── 4.svg
    ├── 5.webp
    ├── 6.gif
    └── index.html
```

Для того чтобы пользователям было удобнее и проще работать с приложением, рекомендуется подготовить и загрузить инструкцию.
Инструкция представляет собой один html-файл с приложенными к нему картинками (скриншотами).
Инструкция отображается на странице приложения на витрине МоегоСклада, а также в главном iframe приложения.
Загрузка инструкции происходит в окне редактирования [черновика или версии приложения](#zhiznennyj-cikl-prilozheniq).
После загрузки инструкция будет храниться на нашем сервере и всегда будет доступна для пользователя, вам больше не нужно будет поддерживать ее доступность самостоятельно.

Требования к файлам инструкции:

1. Подготовленные файлы инструкции перед загрузкой должны быть упакованы в zip-архив размером не более 3 Мб.
2. Файл инструкции должен называться index.html и находиться в корне архива. Наличие других html-файлов в архиве не допускается.
3. Для автоматического построения оглавления html-файла необходимо 
   * чтобы заголовки разделов были оформлены тегами `<h2>`
   * чтобы в теге `head` был подключен [js-скрипт](https://apps-api.moysklad.ru/js/ns/appstore/app/v1/moysklad-manual.js)
4. Для настройки стилей необходимо, чтобы в теге `head` был подключен [файл стилей](https://apps-api.moysklad.ru/js/ns/appstore/app/v1/moysklad-manual.css)
5. Допустимые форматы картинок: png, jpeg, gif, webp, svg.
6. Файлы картинок могут находиться как в корне, так и в папках внутри архива.

Пример html-файла и архива инструкции приведен в правой части экрана.

### Изображения для страницы решения

Для того чтобы заинтересовать пользователей и визуально показать преимущества решения, рекомендуется подготовить и загрузить несколько изображений, дополняющих текстовое описание.
Загрузка изображений происходит в окне редактирования [черновика или версии решения](#zhiznennyj-cikl-prilozheniq).

После загрузки изображения будут храниться на нашем сервере. 
Их уменьшенные копии (превью) будут отображаться на странице решения на витрине МоегоСклада перед текстовым описанием.
Если нажать на превью, изображение откроется в полном размере.

Требования к файлам изображений:

1. Файлы изображений должны быть в формате PNG (предпочтительно) или JPEG. 
2. Размер изображений для загрузки фиксирован и составляет 1280x720 пикселей. 
3. Размер каждого файла - не более 1 Мб.
4. Максимальное количество изображений - 7. Рекомендуемое - от 2-х до 4-х.

Пример оформления изображений можно увидеть на [странице решения Онлайн-заказ](https://online.moysklad.ru/app/#apps?id=f0e50ffd-e267-46bf-a963-0adcf2fe09e0).
