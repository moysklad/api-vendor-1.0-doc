### Процесс активации приложения на аккаунте

Активация приложения — это процесс включения приложения для конкретного аккаунта в системе разработчика. Выполняется при подключении приложения пользователем или при возобновлении платного приложения. В рамках активации происходит оповещение сервера разработчика со стороны МоегоСклада.

В общем виде процесс активации приложения выглядит так:

1. Пользователь МоегоСклада устанавливает приложение. 
2. МойСклад делает HTTP PUT запрос на сервер разработчика, в том числе передавая причину активации и токен доступа к JSON API, если в дескрипторе приложения такой доступ запрашивается. При этом доступ по переданному токену уже работает.
3. Сервер разработчика в рамках допустимого тайм-аута отвечает на запрос одним из статусов в теле ответа:
    + **Activating** — статус предназначен для асинхронной активации на стороне разработчика — если в рамках 
    допустимого тайм-аута обработки HTTP PUT запроса не получается активировать приложение. Например, для активации 
    приложения требуется несколько минут. Далее разработчик должен оповестить МойСклад через эндпоинт **Изменение статуса приложения на аккаунте** о завершении активации приложения статусом **Activated** или о том, что 
    приложению требуется настройка статусом **SettingsRequired**.
    + **SettingsRequired** — статусом, с помощью которого разработчик сообщает МоемуСкладу, что приложению требуется настройка пользователем через iframe-часть приложения. После того, как пользователь настроит приложение, разработчик должен оповестить МойСклад через эндпоинт **Обратного вызова изменения статуса приложения на аккаунте** об активации приложения, передав статус **Activated**.
    + **Activated** — статус означает, что приложение сразу было полностью активировано и уже работает.

Диаграмма деятельности активации приложения:

![useful image](diag_activate.png)

### Процесс деактивации приложения на аккаунте

Деактивация приложения — это процесс выключения приложения для конкретного аккаунта в системе разработчика. Выполняется при отключении приложения пользователем или при приостановке платного приложения. При деактивации происходит оповещение сервера разработчика со стороны МоегоСклада.

Процесс деактивации приложения гораздо проще процесса активации:

1. Пользователь МоегоСклада нажимает на кнопку **Удалить** в карточке приложения.
    + **Для платных приложений возможна приостановка в случаях:** 
        + У пользователя, на аккаунте которого есть установленные платные приложения, кончается подписка.
        + Пользователь, на аккаунте которого есть установленные платные приложения, оплачивает подписку меньшей суммой, чем требуется для оплаты установленных платных приложений.        
2. МойСклад аннулирует доступ по токену, если он был выдан, и выполняет HTTP DELETE запрос с причиной деактивации к серверу разработчика. На момент получения разработчиком оповещения по деактивации доступ по токену уже не работает.

Диаграмма деятельности деактивации приложения:

![useful image](diag_deactivate.png)

### Процесс приостановки и возобновления работы приложения на аккаунте

Приостановка приложения — это автоматический процесс выключения платного приложения при отсутствии на счету пользователя
МоегоСклада суммы, необходимой для оплаты подписки. После
приостановки [токен доступа приложения](#dostup-po-tokenu-k-json-api) аннулируется. Первыми приостанавливаются последние
установленные приложения на аккаунте.

Возобновление приложения — это процесс включения приостановленного платного приложения.
Возобновление может быть выполнено:

- автоматически после пополнения баланса, если в приложении включено автопродление
- вручную пользователем МоегоСклада, если в приложении выключено автопродление

После возобновления приложению выдается новый [токен доступа](#dostup-po-tokenu-k-json-api). Первыми возобновляются
приложения, установленные ранее других приложений.



